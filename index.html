<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Fun</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        
        
        


    </head>
    <style type="text/css">

        .bars rect {
            fill: red;
        }
        .bars text {
            fill: white;
            font: 16px sans-serif;
            font-family: Helvetica;
            font-weight: bold;
            text-anchor: start;
        }
    </style>
    <body>
        <button onclick="plot('data.csv')">data</button>
        <button onclick="plot('data2.csv')">data2</button>
        <button onclick="plot('data3.csv')">data3</button>
        <div style="clear: both; margin-bottom:10px;"></div>
        <svg class="bars"></svg>
                <script type="text/javascript">

    // chart size
    var width = 1200,
        barHeight = 20;

    // map the width of the bars with the max width of the container
    var x = d3.scale.linear()
        .range([0, width]);

    // select the canvas and add attributes
    var chart = d3.select(".bars")
        .attr("width", width);




function plot(filename) {

    chart.selectAll("g").remove();

    d3.csv(filename, typer, function(error, data) {
        x.domain([0, d3.max(data, function(d) { return d.value; })]);

        chart.attr("height", (barHeight+3) * data.length);
            // .attr("height", (barHeight+3) * data.length); // adding 3px here to each bar because they are added as top margin in the creation of the bar

        // create svg elements (g tags) for each element in the dataset
        var bar = chart.selectAll("g")
                .data(data)
            .enter().append("g")
                .attr("transform", function(d, i) { return "translate(0," + i * (barHeight+3) + ")"; }); // adding 3px as margin top

        // create the bar shape appending rect tags inside the g with inline attributes
        bar.append("rect")
            .attr("width", function(d) { return x(d.value); })
            .attr("height", barHeight)
            .attr("rx", 5)
            .attr("ry", 2);

        // insert value of the element in the dataset as text into text tags with inline attributes
        bar.append("text")
            //.attr("x", function(d) { return x(d) - 3; }) // tweaked positioning for text aligned right
            .attr("x", 3)
            .attr("y", barHeight / 2)
            .attr("dy", ".35em")
            .text(function(d) { return d.value; });
    });

    function typer(d) {
        d.value = +d.value; // coerce to number
        return d;
    }
  
  }  


plot("data.csv");


        </script>

       

    </body>
</html>